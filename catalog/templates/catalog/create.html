{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Проверка авторизации -->
    {% if not user.is_authenticated %}
        <div class="alert alert-warning">
            <p>Вам нужно войти в аккаунт, чтобы выполнить это действие.</p>
            <a href="{% url 'login' %}" class="btn btn-primary">Войти</a>
        </div>
        <!-- Прерываем отображение формы, если пользователь не вошёл -->
        {% else %}

        <h1>Добавить продукт</h1>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            {% if form.errors %}
                <div class="alert alert-danger">
                    <strong>Исправьте ошибки:</strong>
                    {{ form.errors }}
                </div>
            {% endif %}

            <div class="mb-3">
                {{ form.name.label_tag }}
                {{ form.name|add_class:"form-control" }}
                {% if form.name.help_text %}
                    <small class="text-muted">{{ form.name.help_text }}</small>
                {% endif %}
            </div>

            <div class="mb-3">
                {{ form.description.label_tag }}
                {{ form.description|add_class:"form-control" }}
            </div>

            <div class="mb-3">
                {{ form.category.label_tag }}
                {{ form.category|add_class:"form-control" }}
            </div>

            <div class="mb-3">
                {{ form.price.label_tag }}
                {{ form.price|add_class:"form-control" }}
            </div>

            <div class="mb-3">
                {{ form.image.label_tag }}
                {{ form.image|add_class:"form-control-file" }}
            </div>

            <button type="submit" class="btn btn-primary">Сохранить</button>
            <a href="{% url 'catalog:product_list' %}" class="btn btn-secondary">Назад</a>
        </form>
    {% endif %}
{% endblock %}
